"use strict";(()=>{var e={};e.id=2277,e.ids=[2277],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},87162:(e,r,a)=>{a.r(r),a.d(r,{headerHooks:()=>c,originalPathname:()=>h,requestAsyncStorage:()=>m,routeModule:()=>d,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p,staticGenerationBailout:()=>_});var t={};a.r(t),a.d(t,{POST:()=>l}),a(95655);var s=a(83323),i=a(54647),o=a(66886),n=a(93439);async function l(e){try{let{maleUserId:r}=await e.json();if(!r)return o.Z.json({error:"Male user ID is required"},{status:400});let{data:a,error:t}=await n.p.from("profile_assignments").select("female_user_id").eq("male_user_id",r);if(t)return console.error("Assignment fetch error:",t),o.Z.json({error:"Failed to fetch assignments"},{status:500});let s=(a||[]).map(e=>e.female_user_id),{data:i,error:l}=await n.p.from("permanent_matches").select("female_user_id");if(l)return console.error("Permanent matches fetch error:",l),o.Z.json({error:"Failed to fetch permanent matches"},{status:500});let u=(i||[]).map(e=>e.female_user_id),{data:d,error:m}=await n.p.from("temporary_matches").select("female_user_id, male_user_id").eq("male_disengaged",!1).eq("female_disengaged",!1);if(m)return console.error("Temporary matches fetch error:",m),o.Z.json({error:"Failed to fetch temporary matches"},{status:500});let p=[...(d||[]).map(e=>e.female_user_id),...(d||[]).map(e=>e.male_user_id)],{data:f,error:c}=await n.p.from("users").select(`
        id,
        full_name,
        age,
        university,
        profile_photo,
        bio
      `).eq("gender","female");if(c)return console.error("Supabase error:",c),o.Z.json({error:"Failed to fetch available profiles"},{status:500});let _=(f||[]).filter(e=>!s.includes(e.id)&&!u.includes(e.id)&&!p.includes(e.id)),h=[];for(let e of _){let{data:r}=await n.p.from("profile_assignments").select("id",{count:"exact"}).eq("female_user_id",e.id),{data:a}=await n.p.from("temporary_matches").select("id").eq("female_user_id",e.id).eq("male_disengaged",!1).eq("female_disengaged",!1).single();h.push({...e,assignment_count:r?.length||0,in_temp_zone:!!a})}return h.sort((e,r)=>e.assignment_count-r.assignment_count),o.Z.json({profiles:h})}catch(e){return console.error("Available profiles fetch error:",e),o.Z.json({error:"Internal server error"},{status:500})}}let u=s.AppRouteRouteModule,d=new u({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/available-profiles/route",pathname:"/api/admin/available-profiles",filename:"route",bundlePath:"app/api/admin/available-profiles/route"},resolvedPagePath:"/home/aman/Desktop/cufy_3.1v/app/api/admin/available-profiles/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:m,staticGenerationAsyncStorage:p,serverHooks:f,headerHooks:c,staticGenerationBailout:_}=d,h="/api/admin/available-profiles/route"},54647:(e,r)=>{var a;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))}};var r=require("../../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[8336,6886,3433,7221],()=>a(87162));module.exports=t})();