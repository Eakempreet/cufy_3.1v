"use strict";(()=>{var e={};e.id=1607,e.ids=[1607],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},85477:e=>{e.exports=require("punycode")},12781:e=>{e.exports=require("stream")},57310:e=>{e.exports=require("url")},59796:e=>{e.exports=require("zlib")},35657:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>c,originalPathname:()=>_,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>f,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>g});var s={};t.r(s),t.d(s,{POST:()=>u}),t(95655);var a=t(83323),n=t(54647),i=t(66886),o=t(93439);async function u(e){try{let{maleUserId:r,femaleUserId:t}=await e.json();if(!r||!t)return i.Z.json({error:"Both male and female user IDs are required"},{status:400});let{data:s,error:a}=await o.p.from("users").select("payment_confirmed, subscription_status, full_name").eq("id",r).single();if(a||!s)return i.Z.json({error:"Male user not found"},{status:404});if(!s.payment_confirmed)return i.Z.json({error:`Cannot assign profile to ${s.full_name}. Payment not yet confirmed.`},{status:400});if("active"!==s.subscription_status)return i.Z.json({error:`Cannot assign profile to ${s.full_name}. Subscription is not active.`},{status:400});let{data:n}=await o.p.from("profile_assignments").select("id").eq("male_user_id",r).eq("female_user_id",t).single();if(n)return i.Z.json({error:"Assignment already exists between these users"},{status:400});let u={male_user_id:r,female_user_id:t,status:"assigned",male_revealed:!1,female_revealed:!1,assigned_at:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:l,error:p}=await o.p.from("profile_assignments").insert(u).select().single();if(p)return console.error("Assignment creation error:",p),i.Z.json({error:"Failed to create assignment"},{status:500});return i.Z.json({success:!0,assignment:l,message:"Profile assigned successfully"})}catch(e){return console.error("Assign profile error:",e),i.Z.json({error:"Internal server error"},{status:500})}}let l=a.AppRouteRouteModule,p=new l({definition:{kind:n.x.APP_ROUTE,page:"/api/admin/assign-profile/route",pathname:"/api/admin/assign-profile",filename:"route",bundlePath:"app/api/admin/assign-profile/route"},resolvedPagePath:"/home/aman/Desktop/cufy_3.1v/app/api/admin/assign-profile/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:f,headerHooks:c,staticGenerationBailout:g}=p,_="/api/admin/assign-profile/route"},54647:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[8336,6886,3433,7221],()=>t(35657));module.exports=s})();