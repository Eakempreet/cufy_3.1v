(()=>{var e={};e.id=3790,e.ids=[3790],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},85477:e=>{"use strict";e.exports=require("punycode")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},63501:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>m,routeModule:()=>p,tree:()=>d});var a=t(73137),r=t(54647),l=t(4183),n=t.n(l),i=t(71775),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(s,c);let o=a.AppPageRouteModule,d=["",{children:["payment",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,14518)),"/home/aman/Desktop/cufy_3.1v/app/payment/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,68350)),"/home/aman/Desktop/cufy_3.1v/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,51918,23)),"next/dist/client/components/not-found-error"]}],m=["/home/aman/Desktop/cufy_3.1v/app/payment/page.tsx"],x="/payment/page",u={require:t,loadChunk:()=>Promise.resolve()},p=new o({definition:{kind:r.x.APP_PAGE,page:"/payment/page",pathname:"/payment",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},82481:(e,s,t)=>{Promise.resolve().then(t.bind(t,93087))},93087:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>T});var a=t(60080),r=t(9885),l=t(74284),n=t(57114),i=t(97052),c=t(68384),o=t(24796),d=t(91971),m=t(23161);let x=(0,d.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),u=r.forwardRef(({className:e,variant:s,...t},r)=>a.jsx("div",{ref:r,role:"alert",className:(0,m.cn)(x({variant:s}),e),...t}));u.displayName="Alert";let p=r.forwardRef(({className:e,...s},t)=>a.jsx("h5",{ref:t,className:(0,m.cn)("mb-1 font-medium leading-none tracking-tight",e),...s}));p.displayName="AlertTitle";let h=r.forwardRef(({className:e,...s},t)=>a.jsx("div",{ref:t,className:(0,m.cn)("text-sm [&_p]:leading-relaxed",e),...s}));h.displayName="AlertDescription";var g=t(27157),b=t(79803),y=t(44901),f=t(15441),j=t(78260),N=t(38674),v=t(81333),w=t(1264),P=t(56388),S=t(6315),k=t(43917),_=t(976),Z=t(14172),C=t(76494),q=t(19413),U=t(43907);function I({subscriptionType:e,onPaymentProofUploaded:s}={}){let[t,l]=(0,r.useState)(900),[d,m]=(0,r.useState)(null),[x,p]=(0,r.useState)(!1),[I,T]=(0,r.useState)(null),[R,z]=(0,r.useState)(!1),[E,A]=(0,r.useState)(!1),[D,O]=(0,r.useState)(null),[Y,L]=(0,r.useState)(null),[M,$]=(0,r.useState)(null),[G,B]=(0,r.useState)(null),[F,Q]=(0,r.useState)(1),V=(0,n.useRouter)(),H=(0,n.useSearchParams)(),J=e||H.get("plan"),W="9773978753@fam",X="Aman Singh",K="basic"===J?99:"premium"===J?249:500,ee="upi://pay?pa=9773978753@fam&pn=Aman%20Singh";(0,r.useEffect)(()=>{let e=async()=>{try{let e=await U.toDataURL(ee,{width:280,margin:2,color:{dark:"#1a1a1a",light:"#ffffff"}});$(e)}catch(e){console.error("QR code generation failed:",e)}};J&&e()},[J,ee]),(0,r.useEffect)(()=>{if(!J){V.push("/subscription-selection");return}er(),ea()},[J]),(0,r.useEffect)(()=>{if(t>0&&!E&&!Y?.payment_confirmed){let e=setTimeout(()=>l(t-1),1e3);return()=>clearTimeout(e)}},[t,E,Y]);let es=async(e,s)=>{try{await navigator.clipboard.writeText(e),B(s),setTimeout(()=>B(null),2e3)}catch(e){console.error("Copy failed:",e)}},et=e=>{window.location.href="upi://pay?pa=9773978753@fam&pn=Aman%20Singh"},ea=async()=>{try{let e=await fetch("/api/user/check"),s=await e.json();s.exists&&s.user&&(L(s.user),s.user.payment_proof_url&&(O(s.user.payment_proof_url),T(s.user.payment_proof_url)))}catch(e){console.error("Error checking existing payment:",e)}},er=async()=>{try{m({basic:{price:99,name:"Basic Plan"},premium:{price:249,name:"Premium Plan"}}[J]||{price:K,name:`${J?.toUpperCase()} Plan`})}catch(e){console.error("Error fetching plan details:",e),m({price:K,name:`${J?.toUpperCase()} Plan`})}},el=async()=>{if(I&&d){z(!0);try{let e=await fetch("/api/user/payment-proof",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({payment_proof_url:I})});e.ok?(A(!0),s?s():setTimeout(()=>{V.push("/dashboard")},2e3)):console.error("Failed to submit payment proof")}catch(e){console.error("Error submitting payment proof:",e)}finally{z(!1)}}};return d?E?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx(i.Zb,{className:"bg-white border shadow-lg max-w-md mx-auto",children:(0,a.jsxs)(i.aY,{className:"text-center p-8",children:[a.jsx("div",{className:"w-20 h-20 bg-green-500 rounded-full flex items-center justify-center mx-auto mb-6",children:a.jsx(g.Z,{className:"h-10 w-10 text-white"})}),a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Payment Submitted!"}),a.jsx("p",{className:"text-gray-600 mb-6",children:"Thank you! Your payment proof has been submitted successfully. Our team will review it shortly and confirm your payment."}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:a.jsx("p",{className:"text-blue-800 text-sm",children:"You will receive confirmation within 24 hours. Redirecting to dashboard..."})}),a.jsx(c.z,{onClick:()=>V.push("/dashboard"),className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Dashboard"})]})})}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white border-b shadow-sm",children:a.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)(c.z,{variant:"ghost",onClick:()=>V.back(),className:"text-gray-600 hover:text-gray-800",children:[a.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Back"]}),a.jsx("div",{className:"h-6 w-px bg-gray-300"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(y.Z,{className:"h-5 w-5 text-green-600"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Secure Payment"})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 bg-red-50 px-3 py-1 rounded-full",children:[a.jsx(f.Z,{className:"h-4 w-4 text-red-600"}),a.jsx("span",{className:"text-sm font-medium text-red-600",children:`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`})]})]})})}),a.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4 sm:py-8",children:(0,a.jsxs)("div",{className:"grid lg:grid-cols-3 gap-4 lg:gap-8",children:[a.jsx("div",{className:"lg:col-span-1 order-2 lg:order-1",children:(0,a.jsxs)(i.Zb,{className:"bg-white border shadow-sm",children:[a.jsx(i.Ol,{className:"pb-4",children:a.jsx(i.ll,{className:"text-lg font-semibold text-gray-900",children:"Order Summary"})}),(0,a.jsxs)(i.aY,{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-3 border-b",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-gray-900 capitalize",children:[J," Plan"]}),a.jsx("p",{className:"text-sm text-gray-500",children:"1 month subscription"})]}),(0,a.jsxs)("p",{className:"font-semibold text-gray-900",children:["₹",K]})]}),(0,a.jsxs)("div",{className:"space-y-2 py-3 border-b",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Subtotal"}),(0,a.jsxs)("span",{className:"text-gray-900",children:["₹",K]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-600",children:"Processing Fee"}),a.jsx("span",{className:"text-green-600",children:"Free"})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center pt-3",children:[a.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total"}),(0,a.jsxs)("span",{className:"text-2xl font-bold text-gray-900",children:["₹",K]})]})]})]})}),(0,a.jsxs)("div",{className:"lg:col-span-2 order-1 lg:order-2",children:[1===F&&(0,a.jsxs)(i.Zb,{className:"bg-white border shadow-sm",children:[a.jsx(i.Ol,{className:"pb-6",children:(0,a.jsxs)(i.ll,{className:"text-xl font-semibold text-gray-900 flex items-center",children:[a.jsx(j.Z,{className:"h-5 w-5 mr-3 text-blue-600"}),"Choose Payment Method"]})}),(0,a.jsxs)(i.aY,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"border-2 border-blue-200 rounded-xl p-6 bg-blue-50",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center",children:a.jsx(N.Z,{className:"h-5 w-5 text-white"})}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:"UPI Payment"}),a.jsx("p",{className:"text-sm text-gray-600",children:"Instant payment via UPI apps"})]})]}),a.jsx(o.C,{className:"bg-green-100 text-green-800 border-green-200",children:"Recommended"})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg p-4 md:p-6 border text-center",children:[a.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Scan QR Code"}),a.jsx("div",{className:"w-40 h-40 sm:w-48 sm:h-48 mx-auto bg-white rounded-lg border-2 border-gray-200 flex items-center justify-center mb-4",children:M?a.jsx("img",{src:M,alt:"UPI QR Code",className:"w-full h-full object-contain rounded-lg"}):a.jsx(v.Z,{className:"h-16 w-16 sm:h-20 sm:w-20 text-gray-400"})}),a.jsx("p",{className:"text-sm text-gray-600",children:"Open any UPI app and scan this code"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-medium text-gray-900",children:"Payment Details"}),(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"UPI ID"}),a.jsx("p",{className:"font-mono text-gray-900",children:W})]}),a.jsx(c.z,{variant:"outline",size:"sm",onClick:()=>es(W,"UPI ID"),className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:"UPI ID"===G?a.jsx(w.Z,{className:"h-4 w-4"}):a.jsx(P.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Name"}),a.jsx("p",{className:"font-medium text-gray-900",children:X})]}),a.jsx(c.z,{variant:"outline",size:"sm",onClick:()=>es(X,"Name"),className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:"Name"===G?a.jsx(w.Z,{className:"h-4 w-4"}):a.jsx(P.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2 border-t",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm text-gray-600",children:"Amount"}),(0,a.jsxs)("p",{className:"text-lg font-bold text-gray-900",children:["₹",K]})]}),a.jsx(c.z,{variant:"outline",size:"sm",onClick:()=>es(K.toString(),"Amount"),className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:"Amount"===G?a.jsx(w.Z,{className:"h-4 w-4"}):a.jsx(P.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Quick Pay"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{name:"PhonePe",url:"phonepe://pay",color:"bg-purple-600 hover:bg-purple-700"},{name:"Google Pay",url:"tez://upi/pay",color:"bg-blue-600 hover:bg-blue-700"},{name:"Paytm",url:"paytmmp://pay",color:"bg-indigo-600 hover:bg-indigo-700"},{name:"BHIM UPI",url:"upi://pay",color:"bg-green-600 hover:bg-green-700"}].map(e=>(0,a.jsxs)(c.z,{onClick:()=>et(e.url),className:`${e.color} text-white`,children:[a.jsx(N.Z,{className:"h-4 w-4 mr-2"}),e.name]},e.name))})]})]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t",children:a.jsx(c.z,{onClick:()=>Q(2),className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 text-lg font-medium",children:"I've completed the payment"})})]}),a.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[a.jsx(y.Z,{className:"h-5 w-5 text-green-600 mt-0.5"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Your payment is secure"}),a.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"We use industry-standard encryption to protect your data. Your card details are never stored on our servers."})]})]})})]})]}),2===F&&(0,a.jsxs)(i.Zb,{className:"bg-white border shadow-sm",children:[a.jsx(i.Ol,{children:(0,a.jsxs)(i.ll,{className:"text-xl font-semibold text-gray-900 flex items-center",children:[a.jsx(S.Z,{className:"h-5 w-5 mr-3 text-blue-600"}),"Upload Payment Proof"]})}),(0,a.jsxs)(i.aY,{className:"space-y-6",children:[(0,a.jsxs)(u,{className:"bg-blue-50 border-blue-200",children:[a.jsx(k.Z,{className:"h-4 w-4 text-blue-600"}),a.jsx(h,{className:"text-blue-800",children:"Please upload a clear screenshot of your payment confirmation to verify your transaction quickly."})]}),(0,a.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-6 md:p-8 text-center hover:border-blue-400 transition-colors",children:[a.jsx(_.Z,{className:"h-10 w-10 md:h-12 md:w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Upload Screenshot"}),a.jsx("p",{className:"text-gray-600 mb-6 text-sm md:text-base",children:"Take a screenshot of your payment confirmation and upload it here"}),a.jsx(q.Z,{onImageUploaded:e=>T(e),currentImage:I||void 0,className:"w-full",uploadType:"payment-proof",userId:Y?.id||"temp"})]}),I&&a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[a.jsx(g.Z,{className:"h-5 w-5 text-green-600"}),(0,a.jsxs)("div",{children:[a.jsx("p",{className:"font-medium text-green-900",children:"Payment proof uploaded!"}),a.jsx("p",{className:"text-sm text-green-700",children:"Click submit to complete your order"})]})]})}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4",children:[(0,a.jsxs)(c.z,{variant:"outline",onClick:()=>Q(1),className:"flex-1 border-gray-300 text-gray-700 hover:bg-gray-50 flex items-center justify-center",children:[a.jsx(b.Z,{className:"h-4 w-4 mr-2"}),"Back to Payment"]}),a.jsx(c.z,{onClick:el,disabled:!I||R,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:R?"Submitting...":"Submit Payment Proof"})]})]})]})]})]})}),a.jsx("div",{className:"border-t bg-white",children:(0,a.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-6 text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(y.Z,{className:"h-4 w-4"}),a.jsx("span",{children:"SSL Encrypted"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(Z.Z,{className:"h-4 w-4"}),a.jsx("span",{children:"Secure Connection"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(C.Z,{className:"h-4 w-4"}),a.jsx("span",{children:"Instant Processing"})]})]}),a.jsx("p",{className:"text-center text-xs text-gray-400 mt-3",children:"Need help? Contact us at support@cufy.com or +91 9876543210"})]})})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsx("div",{className:"text-gray-600",children:"Loading payment details..."})})}function T(){let{data:e}=(0,l.useSession)(),s=(0,n.useRouter)(),[t,i]=(0,r.useState)(!0),[c,o]=(0,r.useState)(null);return(console.log("Payment page mounted, session:",e?.user?.email),(0,r.useEffect)(()=>{console.log("Payment page useEffect running"),console.log("Session:",e?.user?.email);let t=new URLSearchParams(window.location.search),a=t.get("plan");if(console.log("Plan from URL (window.location):",a),console.log("Full URL:",window.location.href),a&&["basic","premium"].includes(a)&&(console.log("Valid plan found, setting planType:",a),o(a)),!e){console.log("No session, but keeping payment page open for now"),i(!1);return}if(!a||!["basic","premium"].includes(a)){console.log("No valid plan found after 2 seconds, redirecting to subscription selection");let e=setTimeout(()=>{s.push("/subscription-selection")},2e3);return()=>clearTimeout(e)}let r=async()=>{try{console.log("Checking user profile...");let e=await fetch("/api/user/check"),t=await e.json();if(console.log("User check response:",t),!t.exists){console.log("User profile does not exist, redirecting to onboarding"),s.push("/boys-onboarding");return}console.log("User profile exists, proceeding with payment page")}catch(e){console.error("Error checking user:",e)}finally{i(!1)}};e&&a&&["basic","premium"].includes(a)?r():i(!1)},[e,s]),t)?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center",children:a.jsx("div",{className:"text-white text-lg",children:"Loading payment details..."})}):c?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:a.jsx(I,{subscriptionType:c,onPaymentProofUploaded:()=>{s.push("/dashboard")}})}):a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center",children:a.jsx("div",{className:"text-white text-lg",children:"Redirecting..."})})}},14518:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>n,__esModule:()=>l,default:()=>c});var a=t(17536);let r=(0,a.createProxy)(String.raw`/home/aman/Desktop/cufy_3.1v/app/payment/page.tsx`),{__esModule:l,$$typeof:n}=r,i=r.default,c=i}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[4650,4433,7345,2730,3174,2866,1063,8687,4516,9378,9413,8384,8799],()=>t(63501));module.exports=a})();