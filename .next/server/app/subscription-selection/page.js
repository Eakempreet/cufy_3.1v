(()=>{var e={};e.id=3454,e.ids=[3454],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},38402:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>m,pages:()=>p,routeModule:()=>h,tree:()=>d});var i=s(73137),a=s(54647),r=s(4183),n=s.n(r),o=s(71775),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let c=i.AppPageRouteModule,d=["",{children:["subscription-selection",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,83563)),"/home/aman/Desktop/cufy_3.1v-1/app/subscription-selection/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,68350)),"/home/aman/Desktop/cufy_3.1v-1/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,51918,23)),"next/dist/client/components/not-found-error"]}],p=["/home/aman/Desktop/cufy_3.1v-1/app/subscription-selection/page.tsx"],m="/subscription-selection/page",x={require:s,loadChunk:()=>Promise.resolve()},h=new c({definition:{kind:a.x.APP_PAGE,page:"/subscription-selection/page",pathname:"/subscription-selection",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},27281:(e,t,s)=>{Promise.resolve().then(s.bind(s,40584))},40584:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>b});var i=s(60080),a=s(9885),r=s(74284),n=s(57114),o=s(65345),l=s(97052),c=s(68384),d=s(24796),p=s(74402),m=s(67932),x=s(91672),h=s(1264),u=s(41516),y=s(15441),g=s(94163);function f({onSelect:e,showSkip:t=!1}={}){let[s,r]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),[N,v]=(0,a.useState)(!1),k=(0,n.useRouter)(),_=async()=>{if(s){if(e){w(!0);try{console.log("Using parent onSelect handler for:",s),await e(s)}catch(e){console.error("Error in onSelect:",e)}finally{w(!1)}return}w(!0);try{console.log("Using internal handler, submitting subscription plan:",s);let e=await fetch("/api/user/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription_type:s})}),t=await e.json();if(console.log("Subscription API response:",t),e.ok){console.log("Subscription successful, redirecting to payment page..."),console.log("Current selectedPlan:",s);let e=`/payment?plan=${s}`;console.log("Navigating to:",e),window.location.href=e,setTimeout(()=>{k.push(e)},100)}else console.error("Failed to select subscription:",t),alert(t.error||"Failed to select subscription. Please try again.")}catch(e){console.error("Error selecting subscription:",e),alert("Network error. Please check your connection and try again.")}finally{w(!1)}}};return(0,i.jsxs)("div",{className:"min-h-screen bg-dark relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 bg-mesh"}),i.jsx("div",{className:"absolute inset-0 overflow-hidden",children:[...Array(15)].map((e,t)=>i.jsx(o.E.div,{className:"absolute rounded-full",style:{left:`${100*Math.random()}%`,top:`${100*Math.random()}%`,width:`${2*Math.random()+1}px`,height:`${2*Math.random()+1}px`,background:`linear-gradient(45deg, rgba(139,92,246,${.5*Math.random()+.3}), rgba(236,72,153,${.5*Math.random()+.3}))`},animate:{y:[-20,20],x:[-10,10],opacity:[.3,.8,.3],scale:[1,1.2,1]},transition:{duration:4+4*Math.random(),repeat:1/0,delay:2*Math.random(),ease:"easeInOut"}},t))}),(0,i.jsxs)("div",{className:"max-w-6xl mx-auto pt-4 px-4 relative z-10",children:[(0,i.jsxs)(o.E.div,{initial:{opacity:0,y:-30},animate:{opacity:1,y:0},transition:{duration:1,ease:[.25,.46,.45,.94]},className:"text-center mb-8",children:[(0,i.jsxs)(o.E.div,{className:"inline-flex items-center space-x-3 bg-white/5 backdrop-blur-3xl border border-white/10 rounded-full px-8 py-4 mb-8",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.8,delay:.2},whileHover:{scale:1.05},children:[i.jsx(o.E.div,{className:"w-3 h-3 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full",animate:{scale:[1,1.2,1],opacity:[.8,1,.8]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}}),i.jsx("span",{className:"text-sm font-medium text-white/90",children:"Profile Complete • Choose Your Plan"})]}),(0,i.jsxs)(o.E.h1,{className:"font-bold leading-tight mb-4 tracking-tight",style:{fontSize:"clamp(1.8rem, 4vw, 2.5rem)",fontFamily:'ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif'},initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:1,delay:.4},children:[i.jsx("span",{className:"block bg-gradient-to-r from-white via-white to-white/95 bg-clip-text text-transparent mb-1",children:"Choose Your"}),i.jsx("span",{className:"block bg-gradient-to-r from-purple-400 via-pink-500 to-purple-600 bg-clip-text text-transparent",children:"Perfect Plan"})]}),(0,i.jsxs)(o.E.p,{className:"text-lg md:text-xl text-white/80 max-w-2xl mx-auto leading-relaxed font-light",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.8,delay:.6},children:["Your profile is ready! Now select how you want to discover meaningful connections.",i.jsx("br",{className:"hidden md:block"}),i.jsx("span",{className:"text-base md:text-lg bg-gradient-to-r from-purple-400 via-pink-500 to-purple-400 bg-clip-text text-transparent font-medium",children:"Start your journey to find love."})]})]}),i.jsx("div",{className:"grid md:grid-cols-2 gap-6 mb-6",children:[{id:"basic",name:"Basic Plan",type:"basic",price:99,duration_days:30,features:{profiles_per_round:1,max_rounds:2,support:"email",choice:!1}},{id:"premium",name:"Premium Plan",type:"premium",price:249,duration_days:30,features:{profiles_per_round:3,max_rounds:2,support:"priority",advanced_filters:!0,choice:!0}}].map((e,t)=>i.jsx(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},children:(0,i.jsxs)(l.Zb,{className:`relative overflow-hidden border-2 transition-all duration-300 cursor-pointer ${s===e.type?"border-pink-500 bg-white/10 shadow-2xl scale-105":"border-white/20 bg-white/5 hover:bg-white/10 hover:border-white/40"}`,onClick:()=>r(e.type),children:["premium"===e.type&&i.jsx("div",{className:"absolute top-4 right-4",children:(0,i.jsxs)(d.C,{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-black font-semibold",children:[i.jsx(p.Z,{className:"w-3 h-3 mr-1"}),"POPULAR"]})}),(0,i.jsxs)(l.Ol,{className:"text-center pb-6",children:[i.jsx("div",{className:"mx-auto mb-4 w-16 h-16 rounded-full bg-gradient-to-r from-pink-500 to-purple-600 flex items-center justify-center",children:"premium"===e.type?i.jsx(m.Z,{className:"w-8 h-8 text-white"}):i.jsx(x.Z,{className:"w-8 h-8 text-white"})}),i.jsx(l.ll,{className:"text-2xl font-bold text-white",children:e.name}),i.jsx(l.SZ,{className:"text-white/60",children:"premium"===e.type?"Maximum choice and flexibility":"Simple and affordable"}),(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsxs)("span",{className:"text-4xl font-bold text-white",children:["₹",e.price]}),(0,i.jsxs)("span",{className:"text-white/60 ml-2",children:["/",e.duration_days," days"]})]})]}),(0,i.jsxs)(l.aY,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-3",children:[(0,i.jsxs)("div",{className:"flex items-center text-white",children:[i.jsx(h.Z,{className:"w-5 h-5 text-green-400 mr-3 flex-shrink-0"}),(0,i.jsxs)("span",{children:[e.features.profiles_per_round," girl profile",e.features.profiles_per_round>1?"s":""," per round"]})]}),(0,i.jsxs)("div",{className:"flex items-center text-white",children:[i.jsx(h.Z,{className:"w-5 h-5 text-green-400 mr-3 flex-shrink-0"}),(0,i.jsxs)("span",{children:[e.features.max_rounds," rounds total"]})]}),"basic"===e.type?(0,i.jsxs)("div",{className:"flex items-start text-white",children:[i.jsx(h.Z,{className:"w-5 h-5 text-green-400 mr-3 flex-shrink-0 mt-0.5"}),(0,i.jsxs)("span",{children:[i.jsx("strong",{children:"No choice"})," - We assign the perfect match for you"]})]}):(0,i.jsxs)("div",{className:"flex items-start text-white",children:[i.jsx(h.Z,{className:"w-5 h-5 text-green-400 mr-3 flex-shrink-0 mt-0.5"}),(0,i.jsxs)("span",{children:[i.jsx("strong",{children:"You choose"})," - Select 1 from 3 profiles to reveal"]})]}),"premium"===e.type&&(0,i.jsxs)("div",{className:"flex items-start text-white",children:[i.jsx(h.Z,{className:"w-5 h-5 text-green-400 mr-3 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:"Other 2 profiles get reassigned to others"})]}),(0,i.jsxs)("div",{className:"flex items-center text-white",children:[i.jsx(h.Z,{className:"w-5 h-5 text-green-400 mr-3 flex-shrink-0"}),(0,i.jsxs)("span",{className:"flex items-center",children:[i.jsx(u.Z,{className:"w-4 h-4 mr-1"}),"priority"===e.features.support?"Priority":"Email"," support"]})]}),(0,i.jsxs)("div",{className:"flex items-center text-white",children:[i.jsx(h.Z,{className:"w-5 h-5 text-green-400 mr-3 flex-shrink-0"}),(0,i.jsxs)("span",{className:"flex items-center",children:[i.jsx(y.Z,{className:"w-4 h-4 mr-1"}),e.duration_days," days validity"]})]})]}),s===e.type&&i.jsx(o.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"pt-4 border-t border-white/20",children:i.jsx("div",{className:"text-center text-sm text-green-400 font-medium",children:"✓ Selected Plan"})})]})]})},e.id))}),(0,i.jsxs)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"text-center space-y-4",children:[i.jsx(c.z,{onClick:_,disabled:!s||j,className:"bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-3 px-8 text-lg disabled:opacity-50",size:"lg",children:j?"Processing...":"Continue to Payment"}),t&&i.jsx("div",{children:i.jsx(c.z,{onClick:()=>{v(!0)},variant:"outline",className:"border-white/30 text-white/70 hover:bg-white/10",children:"Skip for now"})}),i.jsx("p",{className:"text-white/60 mt-4 text-sm",children:"Secure payment • No hidden charges • Cancel anytime"})]}),N&&i.jsx(o.E.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:()=>v(!1),children:(0,i.jsxs)(o.E.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"bg-slate-800 rounded-lg p-6 max-w-md w-full",onClick:e=>e.stopPropagation(),children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx(g.Z,{className:"h-6 w-6 text-yellow-500"}),i.jsx("h3",{className:"text-lg font-semibold text-white",children:"Hold up! \uD83D\uDEAB"})]}),i.jsx("p",{className:"text-white/80 mb-6",children:"Without a subscription, you won't receive any matches! Choose a plan to start connecting with amazing people."}),(0,i.jsxs)("div",{className:"flex space-x-3",children:[i.jsx(c.z,{onClick:()=>v(!1),className:"flex-1 bg-gradient-to-r from-pink-500 to-purple-600",children:"Choose Plan"}),i.jsx(c.z,{onClick:()=>{k.push("/dashboard")},variant:"outline",className:"flex-1 border-red-500 text-red-400 hover:bg-red-500/10",children:"Skip Anyway"})]})]})})]})]})}function b(){let{data:e,status:t}=(0,r.useSession)(),s=(0,n.useRouter)(),[o,l]=(0,a.useState)(!0);if((0,a.useEffect)(()=>{if("loading"===t)return;if("unauthenticated"===t||!e){s.push("/");return}let i=async()=>{try{let e=await fetch("/api/user/check"),t=await e.json();t.exists&&t.user.subscription_type&&t.user.payment_confirmed?(console.log("User already has confirmed subscription, redirecting to dashboard"),s.push("/dashboard")):t.exists?console.log("User profile exists, showing subscription selection"):(console.log("No user profile, redirecting to onboarding"),s.push("/boys-onboarding"))}catch(e){console.error("Error checking subscription:",e)}finally{l(!1)}};i()},[e,s,t]),"loading"===t)return i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsx("div",{className:"text-white",children:"Checking authentication..."})});let c=async e=>{try{l(!0),console.log("Selecting subscription:",e);let t=await fetch("/api/user/subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription_type:e})}),i=await t.json();if(console.log("Subscription response:",i),t.ok){let t=`/payment?plan=${e}`;console.log("Redirecting to:",t),s.push(t)}else console.error("Failed to update subscription:",i),i.requiresMigration?alert("Database needs to be updated. Please contact support."):alert("Failed to select subscription. Please try again.")}catch(e){console.error("Error updating subscription:",e),alert("Network error. Please check your connection and try again.")}finally{l(!1)}};return o?i.jsx("div",{className:"min-h-screen flex items-center justify-center",children:i.jsx("div",{className:"text-white",children:"Loading..."})}):i.jsx("div",{className:"min-h-screen",children:i.jsx(f,{onSelect:c})})}},23161:(e,t,s)=>{"use strict";s.d(t,{cn:()=>r});var i=s(10566),a=s(78126);function r(...e){return(0,a.m6)((0,i.W)(e))}},83563:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>r,default:()=>l});var i=s(17536);let a=(0,i.createProxy)(String.raw`/home/aman/Desktop/cufy_3.1v-1/app/subscription-selection/page.tsx`),{__esModule:r,$$typeof:n}=a,o=a.default,l=o}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),i=t.X(0,[5020,9532,7345,3174,1691,9522,9614],()=>s(38402));module.exports=i})();