"use strict";exports.id=9413,exports.ids=[9413],exports.modules={19413:(e,o,r)=>{r.d(o,{Z:()=>i});var t=r(60080),a=r(9885),l=r(77988),s=r(34516),p=r(976);function i({onImageUploaded:e,currentImage:o,className:r="",uploadType:i="profile",userId:n}){let[m,d]=(0,a.useState)(!1),[c,f]=(0,a.useState)(o||null),h=async o=>{try{let r,t;if(d(!0),!o.target.files||0===o.target.files.length)throw Error("You must select an image to upload.");let a=o.target.files[0];if(!a.type.startsWith("image/"))throw Error("Please select an image file.");if(a.size>("payment-proof"===i?10485760:5242880))throw Error(`Image must be less than ${"payment-proof"===i?10:5}MB.`);let s=a.name.split(".").pop();"payment-proof"===i&&n?(r=`payment_proof_${n}_${Date.now()}.${s}`,t="payment-proofs"):(r=`${Math.random().toString(36).substring(2)}.${s}`,t="profile-photos");let p="payment-proof"===i?r:`profile-photos/${r}`;if("payment-proof"===i){let o=new FormData;o.append("file",a);let r=await fetch("/api/user/payment-proof",{method:"POST",body:o});if(!r.ok){let e=await r.json();throw Error(e.error||"Payment proof upload failed")}let t=await r.json();f(URL.createObjectURL(a)),e(t.payment_proof_url),console.log("Payment proof uploaded successfully via API:",t.payment_proof_url)}else{let{error:o}=await l.O.storage.from(t).upload(p,a,{cacheControl:"3600",upsert:!0});if(o)throw console.error("Upload error:",o),Error(`Upload failed: ${o.message}`);let{data:r}=l.O.storage.from(t).getPublicUrl(p),s=r.publicUrl;f(s),e(s),console.log("Profile photo uploaded successfully:",s)}}catch(e){console.error("Image upload error:",e),alert(e.message||"Failed to upload image. Please try again.")}finally{d(!1)}};return t.jsx("div",{className:`space-y-4 ${r}`,children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[c?t.jsx("div",{className:"relative",children:t.jsx("img",{src:c,alt:"payment-proof"===i?"Payment proof preview":"Profile photo preview",className:"w-28 h-28 sm:w-32 sm:h-32 rounded-lg object-cover border-4 border-white shadow-lg"})}):t.jsx("div",{className:"w-28 h-28 sm:w-32 sm:h-32 rounded-lg border-2 border-dashed border-white/30 flex items-center justify-center",children:t.jsx(p.Z,{className:"h-10 w-10 sm:h-12 sm:w-12 text-white/50"})}),(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-2",children:[t.jsx("input",{type:"file",accept:"image/*",onChange:h,disabled:m,className:"hidden",id:"image-upload"}),t.jsx("label",{htmlFor:"image-upload",children:(0,t.jsxs)(s.z,{type:"button",disabled:m,onClick:()=>document.getElementById("image-upload")?.click(),className:"cursor-pointer bg-gradient-to-r from-pink-500 to-purple-500 hover:from-pink-600 hover:to-purple-600 min-h-[44px] px-4 sm:px-6",children:[t.jsx(p.Z,{className:"mr-2 h-4 w-4"}),m?"Uploading...":c?"Change Photo":"payment-proof"===i?"Upload Payment Proof":"Upload Photo"]})}),(0,t.jsxs)("p",{className:"text-sm text-white/60 text-center",children:["payment-proof"===i?"Upload payment proof (max 5MB)":"Upload profile photo (max 5MB)",t.jsx("br",{}),"Supported: JPG, PNG, WebP, GIF"]})]})]})})}}};